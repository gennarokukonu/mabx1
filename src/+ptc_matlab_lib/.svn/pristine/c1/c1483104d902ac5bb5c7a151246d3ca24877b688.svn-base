function critical_value = tinv_custom(alpha, degrees_of_freedom)
%TINV_CUSTOM: Inverse t-distribution lookup table, which does not require
%the use of the Statistics Toolbox
%   TINV_CUSTOM(ALPHA, DEGREES_OF_FREEDOM)

import('ptc_matlab_lib.*');

%Load variable tinv_table
tinv_table = ...
[NaN 0.05 0.025 0.0125 0.005;
 1 6.313751514675037 12.7062047361747 25.45169957935719 63.65674116287156;
 2 2.919985580353724 4.302652729749462 6.205346816570707 9.924843200918293;
 3 2.353363434801823 3.18244630528371 4.176534846104504 5.840909309733355;
 4 2.13184678632665 2.776445105197793 3.495405932516442 4.604094871349991;
 5 2.015048373333024 2.570581835636315 3.163381449748608 4.032142983555227;
 6 1.943180280515304 2.446911851144969 2.968686684153465 3.707428021324779;
 7 1.894578605090007 2.364624251592785 2.841244248588212 3.499483297350494;
 8 1.859548037530898 2.306004135204166 2.751523596063055 3.355387331333395;
 9 1.833112932656236 2.262157162798204 2.685010846816457 3.249835541592125;
 10 1.812461122811677 2.228138851986274 2.633766915711601 3.169272672616951;
 11 1.795884818704043 2.20098516009164 2.593092682539364 3.10580651553928;
 12 1.782287555649319 2.178812829667228 2.560032959359249 3.054539589392903;
 13 1.770933395986873 2.160368656462792 2.53263781466095 3.012275838716578;
 14 1.761310135774892 2.144786687917804 2.509569411493326 2.976842734370834;
 15 1.753050355692572 2.131449545559774 2.489879703479892 2.946712883475238;
 16 1.745883676276251 2.119905299221256 2.472878322461574 2.9207816224251;
 17 1.739606726075071 2.109815577833314 2.458050720379285 2.898230519677416;
 18 1.734063606617539 2.100922040241039 2.445005616514945 2.878440472738608;
 19 1.72913281152137 2.09302405440831 2.43344021137497 2.86093460646498;
 20 1.724718242920786 2.085963447265864 2.423116539873409 2.845339709786108;
 21 1.72074290281188 2.07961384472768 2.413845016599002 2.83135955802305;
 22 1.71714437438024 2.073873067904024 2.405472746261935 2.818756060600141;
 23 1.71387152774705 2.068657610419049 2.397875064657112 2.80733568377;
 24 1.710882079909429 2.063898561628026 2.39094931512947 2.796939504774456;
 25 1.708140761251898 2.059538552753297 2.384610200804691 2.787435813676971;
 26 1.705617919759273 2.055529438642872 2.378786266235587 2.778714533329682;
 27 1.703288445722123 2.051830516480284 2.373417200912608 2.770682957122209;
 28 1.701130934265933 2.048407141795247 2.368451749168747 2.763262455461446;
 29 1.699127026533497 2.045229642132705 2.36384607320831 2.756385903670604;
 30 1.697260886593958 2.042272456301239 2.359562458700931 2.749995653567225;
 31 1.695518782545864 2.039513446396408 2.355568282159913 2.744041919294268;
 32 1.69388874838371 2.0369333434601 2.351835180376371 2.738481482012186;
 33 1.692360309030347 2.034515297449338 2.34833837725748 2.733276642350837;
 34 1.690924255186856 2.03224450931772 2.345056134345184 2.728394367070721;
 35 1.689572457780266 2.030107928250342 2.341969299301041 2.723805589208091;
 36 1.688297714116814 2.028094000980448 2.339060932574745 2.719484630450005;
 37 1.687093619596259 2.026192463029106 2.336315996909783 2.715408721549986;
 38 1.685954460166718 2.024394163911972 2.333721097687466 2.711557601913084;
 39 1.684875121711239 2.022690920036759 2.331264264658821 2.707913183517661;
 40 1.683851013335629 2.021075390306276 2.328934767569119 2.704459267433165;
 41 1.682878002132706 2.019540970441377 2.326722959691435 2.701181303578522;
 42 1.681952357467542 2.018081702818444 2.324620144463212 2.698066186219984;
 43 1.68107070320248 2.016692199227828 2.32261846134239 2.695102079157678;
 44 1.680229976572168 2.015367574443758 2.320710787728257 2.692278265693019;
 45 1.679427392652355 2.014103388880848 2.318890654370341 2.689585019374643;
 46 1.67866041355688 2.012895598919427 2.317152172150017 2.687013492242214;
 47 1.677926721641813 2.01174051372977 2.315489968490732 2.684555617866528;
 48 1.677224196124317 2.010634757624234 2.313899131951335 2.682204026950217;
 49 1.676550892616902 2.009575237129235 2.312375163800153 2.679951973631548;
 50 1.675905025163111 2.00855911210076 2.310913935564903 2.677793270940843;
 51 1.675284950424904 2.007583770315836 2.309511651715578 2.675722234110649;
 52 1.674689153726005 2.006646805061688 2.308164816770728 2.673733630647222;
 53 1.674116236703116 2.005745995317867 2.306870206227267 2.671822636241002;
 54 1.673564906352145 2.004879288188056 2.30562484080528 2.669984795734893;
 55 1.673033965289899 2.004044783289146 2.304425963575036 2.668215988486195;
 56 1.672522303075581 2.003240718847871 2.303271019596943 2.666512397556063;
 57 1.672028888460893 2.002465459291013 2.302157637758106 2.664870482241977;
 58 1.671552762454831 2.001717484145238 2.301083614533914 2.663286953537661;
 59 1.67109303210392 2.000995378088264 2.30004689944093 2.661758752162966;
 60 1.670648864904532 2.000297822014269 2.299045581978911 2.660283028855045;
 61 1.670219483773768 1.999623584994934 2.29807787988718 2.658857126653923;
 62 1.669804162511976 1.998971517033381 2.297142128563789 2.657478564951159;
 63 1.669402221706774 1.998340542520745 2.296236771514882 2.656145025099865;
 64 1.66901302502399 1.997729654317702 2.29536035171964 2.654854337411091;
 65 1.668635975847545 1.997137908392004 2.294511503809602 2.653604469382925;
 66 1.66827051422767 1.996564418952308 2.293688946974481 2.652393515028312;
 67 1.667916114107358 1.996008354025303 2.292891478516677 2.651219685183663;
 68 1.667572280796582 1.995468931429857 2.292117967986477 2.650081298694739;
 69 1.667238548668657 1.994945415107226 2.291367351837837 2.648976774388618;
 70 1.666914479055899 1.994437111771191 2.290638628551634 2.647904623751156;
 71 1.666599658328472 1.993943367845633 2.289930854179062 2.646863444238397;
 72 1.666293696131516 1.993463566661875 2.289243138264127 2.645851913159329;
 73 1.665996223771397 1.992997125889856 2.288574640107626 2.644868782073385;
 74 1.665706892734031 1.992543495180931 2.287924565339924 2.643912871653088;
 75 1.665425373322488 1.99210215400225 2.287292162773204 2.6429830669674;
 76 1.665151353404641 1.99167260964467 2.286676721506803 2.642078313145996;
 77 1.664884537258215 1.991254395388383 2.286077568262395 2.641197611389271;
 78 1.664624644506594 1.990847068811694 2.285494064927847 2.640340015292128;
 79 1.664371409136486 1.990450210230135 2.284925606291016 2.639504627453226;
 80 1.664124578589623 1.990063421254451 2.28437161794655 2.638690596344187;
 81 1.663883912922542 1.989686323456907 2.283831554360499 2.637897113415781;
 82 1.663649184029058 1.989318557136573 2.28330489707899 2.637123410420375;
 83 1.663420174918869 1.988959780175163 2.282791153068631 2.636368756932125;
 84 1.663196679048877 1.988609666975712 2.282289853177494 2.635632458047963;
 85 1.662978499701899 1.988267907477223 2.28180055070653 2.634913852254306;
 86 1.662765449409064 1.98793420623902 2.281322820082366 2.634212309445636;
 87 1.662557349412856 1.987608281589075 2.280856255623087 2.633527229082497;
 88 1.662354029166803 1.987289864831176 2.280400470389585 2.632858038477652;
 89 1.662155325869672 1.986978699506286 2.279955095115525 2.632204191200012;
 90 1.661961084030099 1.986674540703773 2.279519777209901 2.631565165587163;
 91 1.661771155061706 1.986377154418616 2.279094179826236 2.630940463357764;
 92 1.661585396903226 1.986086316951132 2.278677980993598 2.630329608316288;
 93 1.661403673664926 1.985801814345819 2.278270872804384 2.629732145142831;
 94 1.661225855296616 1.985523441866592 2.277872560654872 2.629147638261696;
 95 1.661051817277307 1.985251003505492 2.27748276253439 2.628575670782738;
 96 1.660881440324856 1.984984311522455 2.277101208359576 2.628015843510069;
 97 1.660714610123054 1.984723186013982 2.276727639350457 2.627467774013251;
 98 1.660551217065747 1.984467454508479 2.276361807445268 2.626931095756373;
 99 1.66039115601696 1.984216951586421 2.276003474751279 2.62640545728083;
 100 1.660234326085493 1.983971518523539 2.275652413028944 2.625890521438006;
 101 1.660080630411793 1.983731002955605 2.275308403207355 2.625385964668442;
 102 1.659929975970339 1.983495258562878 2.274971234928254 2.624891476323913;
 103 1.659782273380312 1.983264144773452 2.274640706117335 2.624406758029951;
 104 1.659637436729175 1.983037526483733 2.274316622580421 2.62393152308561;
 105 1.659495383406826 1.982815273795044 2.273998797622983 2.623465495898082;
 106 1.659356033947384 1.98259726176548 2.273687051691713 2.623008411450003;
 107 1.659219311881047 1.982383370175694 2.273381212036275 2.622560014797039;
 108 1.659085143595805 1.982173483307726 2.273081112390051 2.622120060593693;
 109 1.658953458203057 1.981967489736483 2.272786592668945 2.62168831264598;
 110 1.658824187414208 1.981765282132358 2.27249749868659 2.621264543488586;
 111 1.658697265421481 1.981566757074911 2.272213681885298 2.620848533985445;
 112 1.658572628788207 1.981371814876289 2.271934999081386 2.620440072951827;
 113 1.658450216339888 1.981180359414667 2.271661312224651 2.6200389567972;
 114 1.65832996906778 1.980992297975858 2.271392488170021 2.619644989186654;
 115 1.658211830031327 1.980807541103888 2.271128398461864 2.619257980720755;
 116 1.658095744268684 1.980626002459098 2.270868919129323 2.618877748631975;
 117 1.657981658713433 1.980447598683394 2.270613930492103 2.618504116496795;
 118 1.657869522110739 1.980272249272967 2.270363316976722 2.618136913963051;
 119 1.657759284942949 1.980099876456926 2.27011696694164 2.617775976490851;
 120 1.657650899355267 1.979930405082437 2.269874772511608 2.617421145106862;
 121 1.65754431908742 1.979763762505394 2.269636629420076 2.617072266170868;
 122 1.657439499407335 1.979599878486646 2.269402436859606 2.616729191154005;
 123 1.657336397048834 1.979438685093285 2.269172097339585 2.616391776427956;
 124 1.65723497015076 1.979280116604864 2.268945516551026 2.616059883064613;
 125 1.65713517820348 1.979124109423779 2.268722603237576 2.615733376645134;
 126 1.657036981990742 1.978970601990627 2.268503269073349 2.615412127078786;
 127 1.65694034354208 1.978819534702854 2.268287428545926 2.615096008429865;
 128 1.65684522608156 1.978670849837827 2.268074998845393 2.614784898753303;
 129 1.656751593981654 1.978524491479265 2.267865899758406 2.614478679937813;
 130 1.656659412719401 1.97838040544703 2.267660053567123 2.614177237556356;
 131 1.656568648833578 1.978238539230347 2.267457384952971 2.613880460723622;
 132 1.656479269882309 1.978098841924147 2.267257820904921 2.613588241960239;
 133 1.656391244409319 1.977961264167714 2.267061290631375 2.61330047706259;
 134 1.656304541900904 1.977825758087141 2.266867725476982 2.613017064979459;
 135 1.656219132755785 1.977692277239254 2.266677058842244 2.61273790769331;
 136 1.656134988248166 1.977560776558915 2.266489226107406 2.612462910107563;
 137 1.656052080496351 1.977431212308191 2.266304164559365 2.612191979938524;
 138 1.655970382434064 1.97730354202762 2.266121813321684 2.611925027611981;
 139 1.655889867776078 1.97717772449036 2.265942113288268 2.611661966164882;
 140 1.655810510996925 1.977053719657096 2.265765007058891 2.611402711150337;
 141 1.655732287296965 1.976931488634242 2.265590438878677 2.611147180547816;
 142 1.655655172580958 1.976810993632844 2.265418354579201 2.610895294676288;
 143 1.655579143431739 1.976692197929804 2.265248701522599 2.610646976111526;
 144 1.655504177087628 1.976575065830439 2.265081428547785 2.610402149606683;
 145 1.655430251417661 1.976459562632921 2.264916485919199 2.610160742016444;
 146 1.655357344902153 1.976345654593794 2.264753825277311 2.609922682223985;
 147 1.655285436609551 1.976233308895324 2.264593399591567 2.609687901071345;
 148 1.65521450617872 1.976122493613749 2.264435163114799 2.609456331292214;
 149 1.655144533797901 1.976013177689194 2.264279071339958 2.609227907447895;
 150 1.655075500187109 1.975905330896624 2.264125080958276 2.609002565865541;
 151 1.655007386580362 1.975798923817926 2.263973149819222 2.60878024457904;
 152 1.654940174707902 1.975693927815267 2.263823236892095 2.60856088327223;
 153 1.654873846781301 1.975590315005249 2.26367530222898 2.608344423224263;
 154 1.654808385476529 1.975488058234357 2.263529306929345 2.608130807257307;
 155 1.654743773919979 1.975387131055096 2.263385213105872 2.60791997968609;
 156 1.654679995671815 1.975287507703438 2.263242983851837 2.607711886269706;
 157 1.654617034715018 1.975189163076579 2.263102583209363 2.607506474164828;
 158 1.654554875439398 1.975092072712106 2.262963976139312 2.60730369188121;
 159 1.654493502631322 1.97499621276746 2.262827128491947 2.607103489238449;
 160 1.654432901457286 1.974901560000802 2.262692006979171 2.606905817324884;
 161 1.654373057456591 1.974808091751802 2.262558579147213 2.606710628457436;
 162 1.654313956527191 1.974715785923771 2.262426813350779 2.606517876143431;
 163 1.654255584913725 1.974624620966355 2.262296678728204 2.606327515043793;
 164 1.654197929200051 1.974534575858458 2.262168145176993 2.606139500937217;
 165 1.654140976295227 1.974445630092433 2.262041183330994 2.605953790686228;
 166 1.654084713428876 1.974357763658007 2.261915764537542 2.605770342203771;
 167 1.654029128133711 1.97427095702803 2.261791860836606 2.605589114422052;
 168 1.653974208243469 1.974185191143339 2.261669444939387 2.605410067261303;
 169 1.653919941882009 1.974100447398974 2.261548490208446 2.60523316160042;
 170 1.653866317452313 1.974016707631007 2.26142897063861 2.605058359248647;
 171 1.653813323632679 1.973933954103059 2.26131086083792 2.604885622917745;
 172 1.653760949361772 1.973852169494532 2.261194136010325 2.60471491619603;
 173 1.653709183841045 1.973771336887487 2.261078771937335 2.604546203521989;
 174 1.653658016515946 1.973691439756099 2.260964744962374 2.604379450160473;
 175 1.65360743707941 1.973612461954369 2.260852031973597 2.604214622178031;
 176 1.653557435456031 1.973534387706091 2.260740610389088 2.604051686420588;
 177 1.653508001801321 1.973457201593796 2.260630458141266 2.60389061049074;
 178 1.653459126492523 1.973380888548827 2.260521553662523 2.603731362726497;
 179 1.653410800123474 1.973305433841463 2.260413875871082 2.603573912180473;
 180 1.653363013497324 1.973230823071559 2.260307404157473 2.603418228599892;
 181 1.65331575762289 1.973157042159132 2.260202118371211 2.603264282407075;
 182 1.653269023705181 1.973084077335932 2.260097998808421 2.603112044681007;
 183 1.653222803145805 1.973011915136256 2.259995026199003 2.602961487138741;
 184 1.653177087531101 1.972940542389355 2.259893181695378 2.602812582118426;
 185 1.653131868631895 1.972869946210896 2.259792446860486 2.602665302561972;
 186 1.653087138396923 1.972800113995415 2.259692803656864 2.602519621998782;
 187 1.653042888946608 1.972731033408916 2.259594234436 2.60237551453003;
 188 1.652999112571728 1.972662692381301 2.25949672192757 2.602232954813029;
 189 1.652955801726028 1.972595079099655 2.259400249229682 2.602091918046612;
 190 1.652912949022422 1.972528182001312 2.259304799799014 2.601952379956717;
 191 1.65287054723033 1.972461989767216 2.259210357441224 2.601814316782318;
 192 1.652828589270194 1.972396491315569 2.259116906301942 2.601677705262077;
 193 1.652787068209188 1.972331675795757 2.259024430857904 2.60154252262128;
 194 1.65274597725932 1.97226753258213 2.258932915908201 2.601408746559045;
 195 1.652705309771451 1.972204051268441 2.258842346566143 2.601276355236239;
 196 1.65266505923339 1.972141221662039 2.258752708251029 2.601145327263454;
 197 1.652625219265449 1.972079033778509 2.258663986680439 2.60101564168957;
 198 1.652585783618234 1.972017477836278 2.258576167862512 2.60088727799048;
 199 1.652546746166406 1.971956544251768 2.258489238088866 2.60076021605853;
 200 1.652508100910874 1.971896223633904 2.258403183927002 2.600634436191556;
 Inf 1.644853626951473 1.959963984540054 2.241402727604948 2.575829303548904];

pairs = {'TolType', 'relative', ...
    'TolVal', 1e-8};
parseargs(pairs);

boolean_indices_alpha = is_within_tolerance(tinv_table(1, 2:end), alpha, 'TolType', TolType, 'TolVal', TolVal); %#ok<*COLND>
boolean_indices_dof = is_within_tolerance(tinv_table(2:end, 1), degrees_of_freedom, 'TolType', TolType, 'TolVal', TolVal);

if isempty(find(boolean_indices_alpha, 1)) || isempty(find(boolean_indices_dof, 1))
    error([mfilename ':' thisfuncname ':InvalidInput'], 'One or more inputs are invalid');
end

[X, Y] = meshgrid(tinv_table(1, 2:end), tinv_table(2:end, 1));

critical_value = interp2(X, Y, tinv_table(2:end, 2:end), alpha, degrees_of_freedom, 'nearest');

end